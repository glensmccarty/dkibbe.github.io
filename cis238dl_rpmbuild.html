<h1 id="build-an-rpm-package">Build an RPM Package</h1>

<h2 id="assignment-objectives">Assignment Objectives</h2>

<p>In this assignment you will build and RPM package from the source.</p>

<h2 id="terms-you-should-know">Terms You should Know</h2>



<h2 id="preparation">Preparation</h2>



<h3 id="creating-a-builder">Creating a Builder</h3>

<p>While it is necessary to have root privileges to install a package, packages should <em>not</em> be built as root.</p>

<p>Create a new user to build packages.</p>

<pre><code># useradd rpmbuilder
# passwd rpmbuilder
</code></pre>



<h3 id="installing-rpm-packages">Installing RPM Packages</h3>

<p>As you might guess there are packages to build packages. Install the following:</p>

<pre><code># yum install rpm-build rpmdevtools rpmlint gcc make
</code></pre>

<p>You might also want to install <code>tree</code> and <code>nano</code>.</p>

<h2 id="preparing-the-build-environment">Preparing the Build Environment</h2>



<h3 id="create-the-build-directories">Create the Build Directories</h3>

<p>Log in as <code>rpmbuilder</code> and setup the build tree. The <code>-l</code> option to <code>su</code> assures that you create a login shell.</p>

<pre><code># su -l rpmbuilder
$ rpmdev-setuptree
</code></pre>

<p>The second command will create the build directories.</p>

<h3 id="download-the-source">Download the Source</h3>

<p>Next download the <code>hello</code> source package from a mirror and place it in the <code>~/rpmbuild/SOURCES/</code> directory.</p>

<pre><code>$ cd rpmbuild/SOURCES
$ curl -O http://gnu.askapache.com/hello/hello-2.10.tar.gz
</code></pre>

<h3 id="create-a-spec-file">Create a Spec File</h3>

<pre><code>$ cd ~/rpmbuild/SPECS
$ rpmdev-newspec hello
</code></pre>

<p>The <code>spec</code> file contains the specifications for building the package. The file contains macros with options. Here are the macros that need to be edited. You can use <code>rpmlint</code> to test the finished <code>spec</code> file. The <code>spec</code> file is placed in the ~/rpmbuild/SPEC/` directory.</p>

<dl>
<dt>Name</dt>
<dd>
<p>Enter <strong>Hello</strong> as the name.</p>
</dd>

<dt>Version</dt>
<dd>
<p>This should match the  version of the hello archive downloaded. In this example 2.10.</p>
</dd>

<dt>Summary</dt>
<dd>
<p>The "Hello World" program from GNU</p>
</dd>

<dt>License</dt>
<dd>
<p>This should be <strong>GPLv3+</strong></p>
</dd>

<dt>URL</dt>
<dd>
<p>The web site for the Hello package <a href="http://ftp.gnu.org/gnu/hello">http://ftp.gnu.org/gnu/hello</a></p>
</dd>

<dt>Source0</dt>
<dd>
<p><a href="http://ftp.gnu.org/gnu/hello/hello-2.8.tar.gz">http://ftp.gnu.org/gnu/hello/hello-2.8.tar.gz</a></p>
</dd>

<dt>BuildRequires</dt>
<dd>
<p>What additional packages requred. Use <code>gettext</code> here.</p>
</dd>

<dt>Requires:</dt>
<dd>
<p>Comment out?</p>
</dd>

<dt>%description</dt>
<dd>
<p>The "Hello World" program, done with all bells and whistles of a proper FOSS  <br>
project, including configuration, build, internationalization, help files, etc.</p>
</dd>

<dt>%prep</dt>
<dd>Do not edit.</dd>

<dt>%build</dt>
<dd>Do not edit.</dd>

<dt>%configure</dt>
<dd>Do not edit.</dd>
</dl>

<p>%install</p>

<p>:For now comment this section out upto the next blank line but not the sections below it.</p>



<h3 id="prepared-spec-file">Prepared spec file</h3>

<pre><code>$ curl -O http://dennisk.freeshell.org/other/hello.spec
</code></pre>

<h2 id="build-the-package">Build the Package</h2>

<p>You can use the <code>--nobuld</code> option to test for errors.</p>

<pre><code>$ rpmbuild --nobuild ~/rpmbuild/SPEC/hello.spec
</code></pre>

<p>Then build with:</p>

<pre><code>$ rpmbuild -v -bb ~/rpmbuild/SPEC/hello.spec
</code></pre>

<p>The process should end with and exit code of 0.</p>

<h2 id="install-the-package">Install the Package</h2>

<p>You will need to be root toinstall the pacakage.</p>

<pre><code>$ su -
# cd ~/home/rpmbuilder/rpmbuild/RPM/
# rpm -ivh hello.rpm
</code></pre>

<p>Use the actual package name.</p>

<h2 id="what-to-submit">What to Submit</h2>

<p>Submit a screenshot of the output of <code>rpm -q hello</code></p>

<h2 id="resources">Resources</h2>

<ul>
<li><a href="http://gnu.org/software/hello/">GNU Hello</a></li>
<li><a href="https://fedoraproject.org/wiki/How_to_create_a_GNU_Hello_RPM_package">How to create a GNU Hello RPM package</a></li>
</ul>

<blockquote>
  <p>Written Sith <a href="https://stackedit.io/">StackEdit</a>.</p>
</blockquote>