<h1 id="extending-a-lvm-logical-volume">Extending a LVM Logical Volume</h1>



<h2 id="assignment-objectives">Assignment Objectives</h2>

<p>An advantage of Logical Volume Management (LVM) is how easy it can be extended.  In this assignment you will extend the <code>lv_home</code> logical volume you created by adding LVM extents.</p>

<p><em>When you have successfully completed this assignment you will be able to:</em></p>

<ul>
<li>Add a second virtual hard drive in VirtualBox.</li>
<li>Create a LVM Physical Volume (PV).</li>
<li>Add a PV to a LVM Volume Group (VG).</li>
<li>Extend a LVM Logical Volume (LV).</li>
<li>Extend an ext4 filesystem.</li>
</ul>

<h2 id="terms-and-commands-you-should-know">Terms and Commands  You Should Know</h2>

<ul>
<li>Extents - LVM divides storage into extents (physical and logical extents)</li>
<li>Physical Volume - LVM physical volume are built on block devices such as a partition or physical disk.</li>
<li>Volume Group - Physical volumes are combined into volumes groups creating a pool of storage.</li>
<li>Logical Volume - Volume Groups are divided into logical volumes.</li>
<li><code>pvcreate</code> - Creates a LVM Physical Volume.</li>
<li><code>vgextend</code> - Extends the size of a volume group.</li>
<li><code>lvextend</code> - Extends the size of a logical volume.</li>
<li><code>resize2fs</code> - ext2/ext3/ext4 file system resizer</li>
</ul>

<h2 id="preparation">Preparation</h2>

<p>This assignment should be done on the CentOS virtual machine that you created with a separate <em>/home</em> partition.</p>



<h2 id="install-centos-7-with-a-custom-layout">Install CentOS 7 with a Custom Layout</h2>

<p><img src="https://s3.amazonaws.com/CIS238DL/img/centos_lvm-1.png" alt="Centos LVM Screenshot" title=""></p>

<p><img src="https://s3.amazonaws.com/CIS238DL/img/centos_lvm-2.png" alt="CentOS LVM screenshot" title=""></p>

<p><img src="https://s3.amazonaws.com/CIS238DL/img/centos_lvm-3.png" alt="CentOS LVM screenshot" title=""></p>

<p><img src="https://s3.amazonaws.com/CIS238DL/img/centos_lvm-4.png" alt="CentOS LVM screenshot" title=""></p>

<p><img src="https://s3.amazonaws.com/CIS238DL/img/centos_lvm-5.png" alt="CentOS LVM screenshot" title=""></p>

<p><img src="https://s3.amazonaws.com/CIS238DL/img/centos_lvm-6.png" alt="CentOS LVM screenshot" title=""></p>

<p><img src="https://s3.amazonaws.com/CIS238DL/img/centos_lvm-7.png" alt="CentOS LVM screenshot" title=""></p>

<p><img src="https://s3.amazonaws.com/CIS238DL/img/centos_lvm-8.png" alt="CentOS LVM screenshot" title=""></p>

<h2 id="add-a-second-virtual-drive-to-the-virtual-machine">Add a Second Virtual Drive to the Virtual Machine</h2>

<p>Add a second virtual 1 GiB hard disk to your virtual machine.  You will need to power down the virtual machine before adding the drive.</p>

<p><img src="https://s3.amazonaws.com/CIS238DL/vbox-add_storage.png" alt="https://s3.amazonaws.com/CIS238DL/vbox-add_storage.png" title=""></p>

<p><img src="https://s3.amazonaws.com/CIS238DL/vbox-add_storage2.png" alt="https://s3.amazonaws.com/CIS238DL/vbox-add_storage2.png" title=""></p>

<h2 id="create-the-physical-volume-pv">Create the Physical Volume (PV)</h2>

<p>Before you can attach additional storage to the volume group <em>/dev/sdb</em> must be formatted as an physical volume.</p>

<h2 id="add-the-physical-volume-to-the-volume-group">Add the Physical Volume to the Volume Group</h2>

<p>Use the <code>vgdisplay</code> command to display information about the volume group.  Note that there are no Free PEs available. Now add the physical volume to the volume group. <em>Note:</em> Your volume group name will be different.</p>

<p>Run <code>vgdisplay</code> again and you should now have about 255/1024 MiB available.</p>

<h2 id="extend-the-logical-volume">Extend the logical Volume</h2>

<p>Use the <code>lvextend</code> command to extent the <em>lv_home</em> logical volume.  You can extend using size (MiB, GiB) or extents.  See the <code>lvextend</code> man page for examples.  Here we’ll add all the available extents.</p>

<h2 id="extend-the-filesystem">Extend the filesystem</h2>

<p>Extending the logical volume isn’t enough you also need to extend the filesystem.  The <code>df</code> command shows that <em>lv_home</em> is still 1 GiB. in size.</p>

<h2 id="what-to-submit">What to Submit</h2>

<p>Submit a screen-shot (cropped, of course) of the <code>df -h</code> command showing that <em>/home</em> has been extended.</p>

<h2 id="resources">Resources</h2>

<ul>
<li>man lvm</li>
<li><a href="https://www.youtube.com/watch?v=BysRGDgqtwY">Managing Storage with the Linux Logical Volume Manager (LVM)</a></li>
<li><a href="https://access.redhat.com/site/documentation/en-US/Red_Hat_Enterprise_Linux/6-Beta/html/Logical_Volume_Manager_Administration/index.html">Logical Volume Manager Administration</a></li>
<li><a href="http://debian-handbook.info/browse/stable/advanced-administration.html#section.lvm">The Debian Administrator’s Handbook</a></li>
<li><a href="#dennisk.freeshell.org/cis238dl_lvm.html">Extending a LVM Logical Volume</a></li>
</ul>