<p><img src="https://s3.amazonaws.com/CIS238DL/img/grub_rescue.png" alt="enter image description here" title=""></p>



<h2 id="introduction">Introduction</h2>

<p>The Grand Unified Bootloader (GRUB) is used by almost all Linux distributions. In this assignment you will “break” a CentOS 7 system and then repair it.</p>



<h2 id="learning-objectives">Learning Objectives</h2>

<p><em>After successfully completing this assignment you will be able to:</em></p>

<ol>
<li>Boot from a rescue CD.</li>
<li>Use <code>chroot</code> to access the broken system.</li>
<li>Use GRUB to rebuild the GRUB configuration file.</li>
</ol>



<h2 id="useful-terms">Useful Terms</h2>

<ul>
<li>GRUB</li>
<li><code>chroot</code></li>
</ul>



<h2 id="preparation">Preparation</h2>

<ul>
<li>Import the CentOS 7 minimal ova.</li>
<li>Boot the system and rename <em>/boot/grub2/grub.cfg</em> to <em>grub.bak</em></li>
<li>Reboot the system to a GRUB rescue prompt.</li>
</ul>



<h2 id="rescue">Rescue</h2>



<h3 id="boot-the-rescue-disk">Boot the Rescue Disk</h3>

<ul>
<li>Load the <em>CentOS 7 install ISO</em> into the virtual CD drive.</li>
<li>Make sure the CD is set as the first boot device.</li>
<li>Boot the system and you should see this screen.</li>
</ul>

<p><img src="https://s3.amazonaws.com/CIS238DL/img/grub_rescue-1.png" alt="enter image description here" title=""></p>

<p>Select <em>Troubleshooting</em> </p>

<p><img src="https://s3.amazonaws.com/CIS238DL/img/grub_rescue-2.png" alt="enter image description here" title=""></p>

<p>and then <em>Rescue a CentOS system</em> from the next screen. The rescue CD gives you a number of options. Tab to <em>Continue</em>.</p>

<p><img src="https://s3.amazonaws.com/CIS238DL/img/grub_rescue-3.png" alt="enter image description here" title=""></p>



<h3 id="chroot-into-the-broken-system">Chroot into the Broken System</h3>

<p>Use the <code>chroot</code> command to access the broken system.</p>

<p><img src="https://s3.amazonaws.com/CIS238DL/img/grub_rescue-4.png" alt="enter image description here" title=""></p>



<h3 id="make-a-new-grub-configuration">Make a New GRUB Configuration</h3>

<p>Use <code>cd</code> to navigate to <code>/boot/grub2</code> and run <code>grub2-mkconfig</code> to recreate the configuration file.</p>

<pre><code># grub2-mkconfig --output=grub.cfg
</code></pre>

<p>Type <code>halt</code> to stop the system and then remove the rescue CD.</p>

<p><img src="https://s3.amazonaws.com/CIS238DL/img/grub_rescue-0.png" alt="enter image description here" title=""></p>

<p>Reboot the system and you should be at a login prompt.</p>



<h2 id="what-to-submit">What to Submit</h2>

<p>Submit a screenshot of the output of grub2-mkconfig showing that a new config file is being credted in the correct directory <em>not</em> in stdout.</p>

<h2 id="resources">Resources</h2>

<ul>
<li>man chroot</li>
<li>man grub2-mkconfig</li>
<li><a href="http://dedoimedo.com/computers/grub-2.html">GRUB2 Tutorial</a></li>
<li><a href="http://www.linuxdevcenter.com/pub/a/linux/2008/01/22/lilo-and-grub-boot-loaders-made-simple.html">LILO and GRUB: Boot Loaders Made Simple</a></li>
</ul>

<blockquote>
  <p>Written with <a href="https://stackedit.io/">StackEdit</a>.</p>
</blockquote>